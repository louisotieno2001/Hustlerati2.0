<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= product.name %> | Hustlerati</title>
    <meta name="description" content="<%= product.description %>">
    <meta name="keywords" content="product, <%= product.category %>, <%= product.subcategory %>, Hustlerati">
    <meta name="author" content="Hustlerati Team">
    <link rel="icon" href="/images/logo.png" type="image/x-icon">
    <link rel="stylesheet" href="/stylesheets/default.css">
    <link rel="stylesheet" href="/stylesheets/product.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- Header -->
     <%- include('partials/header') %>

    <main class="product-main">
        <div class="container">
            <div class="product-details">
                <div class="product-gallery">
                    <div class="image-scroll-container">
                        <% if (product.media && product.media.length > 0) { %>
                            <% product.media.forEach(function(media) { %>
                                <% const mediaUrl = media.url || `/shop/proxy/assets/${media.id}`; %>
                                <% const filename = media.filename_download || media.filename_disk || ''; %>
                                <% if (filename.endsWith('.mp4') || filename.endsWith('.webm') || filename.endsWith('.ogg') || filename.endsWith('.mov')) { %>
                                    <video class="product-media" controls preload="metadata">
                                        <source src="<%= mediaUrl %>" type="video/mp4">
                                        <source src="<%= mediaUrl %>" type="video/webm">
                                        <source src="<%= mediaUrl %>" type="video/ogg">
                                        Your browser does not support the video tag.
                                    </video>
                                <% } else if (filename.endsWith('.jpg') || filename.endsWith('.jpeg') || filename.endsWith('.png') || filename.endsWith('.gif') || filename.endsWith('.webp')) { %>
                                    <img class="product-media" src="<%= mediaUrl %>" alt="<%= product.name %>" loading="lazy" onerror="this.style.display='none';this.nextElementSibling.style.display='block';">
                                    <div class="media-fallback" style="display:none;">
                                        <i class="fas fa-shopping-cart"></i>
                                        <span>Product Preview Unavailable</span>
                                    </div>
                                <% } else { %>
                                    <div class="media-fallback">
                                        <i class="fas fa-shopping-cart"></i>
                                        <span>Product Preview</span>
                                    </div>
                                <% } %>
                            <% }); %>
                        <% } else { %>
                            <div class="media-fallback">
                                <i class="fas fa-shopping-bag"></i>
                                <span>Product Item</span>
                            </div>
                        <% } %>
                    </div>
                </div>
                <div class="product-info">
                    <h1><%= product.name %></h1>
                    <div class="product-price">$<%= product.price %></div>
                    <div class="product-description">
                        <p><%- product.description %></p>
                    </div>
                    <% if (product.category) { %>
                        <div class="product-category">
                            <strong>Category:</strong> <%= product.category %>
                        </div>
                    <% } %>
                    <% if (product.subcategory) { %>
                        <div class="product-subcategory">
                            <strong>Subcategory:</strong> <%= product.subcategory %>
                        </div>
                    <% } %>
                    <div class="product-actions">
                        <button class="btn btn-primary add-to-cart" data-id="<%= product.id %>">
                            <i class="fas fa-cart-plus"></i> Add to Cart
                        </button>
                        <a href="/cart" class="btn btn-outline">
                            <i class="fas fa-shopping-cart"></i> Go to Cart
                        </a>
                        <a href="/shop" class="btn btn-outline">
                            <i class="fas fa-arrow-left"></i> Back to Shop
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <%- include('partials/footer') %>
    <script src="/javascript/accessibility.js"></script>
    <script src="/javascript/index.js"></script>
    <script src="/javascript/cart.js"></script>
    <script src="/javascript/product.js"></script>\
    <script src="/javascript/localization.js"></script>
</body>

</html>
